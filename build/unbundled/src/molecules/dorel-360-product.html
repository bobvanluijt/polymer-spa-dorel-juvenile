<html><head><link rel="import" href="../atoms/dorel-loader.html">

</head><body><dom-module id="dorel-360-product">
  <template>
    <style>
      .image {
        margin: auto;
        display: block;
        width: 31em;
        height: 35em;
        touch-action: none;
        background-position: 50% 50%;
        background-repeat: no-repeat;
        background-size: cover;
      }

      .product {
        float: left;
        position: relative;
        /* TODO: Use a var here, this is the Quinny background image color */
        background-color: #d9d9d9;
        width: 31em;
        height: 35em;

      }

      .image {
        opacity: 0;
        transition: opacity .3s ease;
      }

      [preloaded] .image {
        opacity: 1;
      }
    </style>

    <div class="product flex" preloaded$="[[ !loading ]]">
      <dorel-loader loading="[[ loading ]]"></dorel-loader>
      <img style$="background-image: url('[[ currentImage ]]')" class="image" on-track="_handleTrack">
    </div>
  </template>

  <script>Polymer({is:"dorel-360-product",properties:{currentImage:{type:String,value:"../../../assets/images/360viewer/01.jpg"},rotationElement:{type:Object},startTracking:{type:Number},loading:{type:Boolean,value:!0},rotation:{type:Number,value:0},rotationImages:{type:Array,value:[]},rotationImagePaths:{type:Array,value:[]},newPosition:{type:Number},lastPosition:{type:Number}},ready:function(){this._preloadImages()},_preloadImages:function(){for(var t=0;t<this.rotationImagePaths.length;t++)this.rotationImages[t]=new Image,this.rotationImages[t].src=this.rotationImagePaths[t];this.loading=!1},_handleTrack:function(t){switch(t.preventDefault(),t.detail.state){case"start":this.newPosition=t.detail.x,this.lastPosition=t.detail.x;break;case"track":this.lastPosition=this.newPosition,this.newPosition=t.detail.x;var a=this.newPosition-this.lastPosition;a=Math.max(a,-3),a=Math.min(a,3),this.rotation=this.rotation+a;var e=this.rotation%360;e/=360/this.rotationImagePaths.length,e=Math.round(e),e<0&&(e=this.rotationImagePaths.length+e),e=Math.abs(e),this.currentImage=this.rotationImagePaths[e]}return!1}});</script>

</dom-module>
</body></html>