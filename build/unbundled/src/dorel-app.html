<html><head><link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/app-route/app-location.html">
<link rel="import" href="../bower_components/app-route/app-route.html">

<link rel="import" href="../bower_components/app-layout/app-header-layout/app-header-layout.html">
<link rel="import" href="../bower_components/app-layout/app-scroll-effects/effects/waterfall.html">
<link rel="import" href="../bower_components/app-layout/helpers/helpers.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../bower_components/iron-media-query/iron-media-query.html">
<link rel="import" href="../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../bower_components/iron-selector/iron-selector.html">
<link rel="import" href="../bower_components/google-tag-manager/google-tag-manager.html">
<link rel="import" href="../bower_components/beautify-json/beautify-json.html">

<link rel="import" href="organisms/dorel-header.html">
<link rel="import" href="organisms/dorel-footer.html">

<link rel="import" href="molecules/dorel-tabs.html">
<link rel="import" href="molecules/dorel-tab.html">
<link rel="import" href="molecules/dorel-wp-collect-menu.html">
<link rel="import" href="molecules/dorel-wp-collect-page.html">

<link rel="import" href="../assets/cdn/theme-maxicosi-shared-styles.html">
<link rel="import" href="templates/dorel-template.html">

</head><body><dom-module id="dorel-app">
  <template>
    <style is="custom-style" include="theme-maxicosi-shared-styles">
      /* 
       * Application wide styling
       * - Will define standard styling for components
       */
      :host {
        /*display: block;
        position: relative;*/
        padding-top: 130px;
        padding-bottom: 64px;
        min-height: 100vh;

        --primary-color: var(--theme-brand-color);
        color: var(--theme-primary-text-color);

        --app-secondary-color: #757575;
        --app-accent-color: #172C50;
        --paper-button-ink-color: var(--app-accent-color);
        --paper-icon-button-ink-color: var(--app-accent-color);
        --paper-spinner-color: var(--app-accent-color);
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
      }

      :root {

        --paper-input-container-underline: {
          border-bottom: 2px solid var(--theme-brand-color);
        };

        --paper-input-container-focus-color: var(--theme-brand-color-royal-blue);

        --paper-input-container-label-focus: {
          color: var(--theme-brand-color-royal-blue);
        };

      }

      /*
       * this file styling:
       */

      app-header-layout {
        z-index: 9999; /* overrule default */
      }

      app-header {
        @apply(--layout-fixed-top);
        /*z-index: 1;*/
        background-color: rgba(255, 255, 255, 0.95);
        --app-header-shadow: {
          box-shadow: inset 0px 5px 6px -3px rgba(0, 0, 0, 0.2);
          height: 10px;
          bottom: -10px;
        };
      }

      paper-icon-button {
        color: var(--app-primary-color);
      }

      .left-bar-item {
        width: 40px;
      }

      .menu-btn {
        display: none;
      }
      
      :host(:not([page=detail])) .back-btn {
        display: none;
      }

      [hidden] {
        display: none !important;
      }

      #tabContainer {
        position: relative;
        height: 66px;
      }

      dorel-tab {
        --dorel-tab-overlay: {
          color: red;
          
          /*border-bottom: 2px solid var(--theme-color-active);*/
        };
      }

      dorel-tabs {
        height: 100%;
      }

      dorel-tab {
        margin: 0 10px;
      }

      dorel-tab a {
        text-decoration: none;
        outline: none;
        padding: 9px 5px;
        color: var(--theme-primary-text-color);
        @apply(--theme-ui);
        /*display: inline-block;*/
        /*color: var(--app-primary-color);*/
      }

      .iron-selected a {
        font-weight: bold;
        color: yellow;
        color: var(--theme-brand-color);
      }

      .drawer-list {
        margin: 0 20px;
      }

      .drawer-list a {
        display: block;
        padding: 0 16px;
        line-height: 40px;
        text-decoration: none;
        color: var(--app-secondary-color);
      }

      .drawer-list a.iron-selected {
        color: black;
        font-weight: bold;
      }

      app-drawer {
        z-index: 3;
      }

      /* small screen */
      @media (max-width: 767px) {
        :host {
          padding-top: 64px;
        }

        .menu-btn {
          display: block;
        }

        :host([page=detail]) .menu-btn {
          display: none;
        }
      }

    </style>
    
    
    <google-tag-manager cid="GTM-TW3TM86"></google-tag-manager>
  
    
    <app-location route="{{ route }}"></app-location>
    <app-route route="{{ route }}" pattern="/:page" data="{{ routeData }}" tail="{{ subroute }}"></app-route>

    <iron-media-query query="max-width: 767px" query-matches="{{smallScreen}}"></iron-media-query>
    
    <app-header-layout>
      <app-header id="header" effects="waterfall" fixed="[[smallScreen]]" condenses="[[!smallScreen]]" reveals="[[!smallScreen]]">

        <dorel-header>
          
          <div id="tabContainer" sticky$="[[_shouldShowTabs]]" hidden$="[[!_shouldShowTabs]]">
            <wp-collect-menu wp-url="[[ wpUrl ]]" menu-location="main_menu" menu-data="{{ menuData }}">
              <template is="dom-if" if="[[ menuData.length ]]">
                <dorel-tabs selected="[[ page ]]" attr-for-selected="name">
                  <template is="dom-repeat" items="[[ menuData ]]" as="menuItem" initial-count="4">
                    <dorel-tab name="[[menuItem.title]]">
                      <a href="[[menuItem.url]]">[[menuItem.title]]</a>
                    </dorel-tab>
                  </template>
                </dorel-tabs>
              </template>
            </wp-collect-menu>
          </div>
        </dorel-header>

        
        

      </app-header>
    </app-header-layout>

    
    <template is="dom-if" if="[[ _shouldRenderDrawer ]]">
      
      <app-drawer opened="{{ drawerOpened }}" swipe-open="" tabindex="0">
        <wp-collect-menu wp-url="[[ wpUrl ]]" menu-location="main_menu" menu-data="{{ menuData }}">

          <iron-selector role="navigation" class="drawer-list" selected="[[ page ]]" attr-for-selected="name">
            <template is="dom-repeat" items="[[ menuData ]]" as="menuItem" initial-count="4">
              <a name="[[ menuItem.title ]]" href="/list/[[ menuItem.url ]]">[[ menuItem.title ]]</a>
            </template>
          </iron-selector>

        </wp-collect-menu>
      </app-drawer>
    </template>
        
    
    <iron-pages role="main" selected="{{ currentPage.object_id }}" attr-for-selected="page-id" fallback-selection="404">

      <template id="pages" is="dom-repeat" items="[[ menuData ]]" as="pageItem">

        <wp-collect-page wp-url="[[ wpUrl ]]" page-id="[[ pageItem.object_id ]]" page-data="{{ index }}">

          <dorel-template template-name="{{ index.template }}" template-data="{{ index }}"></dorel-template>

        </wp-collect-page>

      </template>

    </iron-pages>

    <dorel-footer></dorel-footer>

  </template>

  <script>window.performance&&performance.mark&&performance.mark("dorel-app - before register"),Polymer({is:"dorel-app",properties:{debug:{type:Boolean,value:!0},page:{type:String,observer:"_pageChanged"},menuData:{type:Array},currentPage:{type:Number},_shouldShowTabs:{computed:"_computeShouldShowTabs(page, smallScreen)"},_shouldRenderTabs:{computed:"_computeShouldRenderTabs(_shouldShowTabs, loadComplete)"},_shouldRenderDrawer:{computed:"_computeShouldRenderDrawer(smallScreen, loadComplete)"}},observers:["_routePageChanged(routeData.page)","_setCurrentPage(page, menuData)"],listeners:{announce:"_onAnnounce","dom-change":"_domChange"},created:function(){window.performance&&performance.mark&&performance.mark("dorel-app.created"),this.removeAttribute("unresolved")},ready:function(){this.debug?this.wpUrl="../../assets/data":this.wpUrl="/wp-json/wp-api-menus/v2",Polymer.RenderStatus.afterNextRender(this,function(){this.listen(window,"online","_notifyNetworkStatus"),this.listen(window,"offline","_notifyNetworkStatus")})},_routePageChanged:function(e){this.page=e||"homepage",Polymer.AppLayout.scroll({top:0,behavior:"silent"}),this.drawerOpened=!1},_pageChanged:function(e,o){null!=e&&"home"==e&&this._pageLoaded(Boolean(o))},_pageLoaded:function(e){this._ensureLazyLoaded(),e&&this.async(function(){this.$.header.resetLayout()},1)},_ensureLazyLoaded:function(){this.loadComplete||Polymer.RenderStatus.afterNextRender(this,function(){this.importHref(this.resolveUrl("../atoms/dorel-lazy-resources.html"),function(){"serviceWorker"in navigator&&navigator.serviceWorker.register("../../service-worker.js"),this._notifyNetworkStatus(),this.loadComplete=!0})})},_notifyNetworkStatus:function(){var e=this.offline;this.offline=!navigator.onLine,(this.offline||!this.offline&&e===!0)&&(this._networkSnackbar||(this._networkSnackbar=document.createElement("dorel-snackbar"),Polymer.dom(this.root).appendChild(this._networkSnackbar)),Polymer.dom(this._networkSnackbar).innerHTML=this.offline?"You are offline":"You are online",this._networkSnackbar.open())},_toggleDrawer:function(){this.drawerOpened=!this.drawerOpened},_showPage404:function(){this.page="404"},_setCurrentPage:function(e,o){o.length&&(this.currentPage=o.find(function(o){return console.log(o),e===o.url.substring(1)&&o.object_id}))},_domChange:function(e){if(window.performance&&performance.mark&&!this.__loggedDomChange){var o=Polymer.dom(e).rootTarget;o.domHost.is.match(this.page)&&(this.__loggedDomChange=!0,performance.mark(o.domHost.is+".domChange"))}},_computeShouldShowTabs:function(e,o){return"undefined"!=typeof e&&!o},_computeShouldRenderTabs:function(e,o){return e&&o},_computeShouldRenderDrawer:function(e,o){return e&&o}});</script>
</dom-module></body></html>
