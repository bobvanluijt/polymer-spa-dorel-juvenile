<dom-module id="dorel-section-multi">
  <template>
    <style include="theme-maxicosi-shared-styles polymer-bootstrap-min">
      .section-multi {
        margin: 50px auto;
        padding-top: 50px;
        padding-bottom: 50px;
      }

      .section-multi .multi-title {
        @apply(--theme-heading);
        font-size: 2.3rem;
        font-weight: bolder;
        text-align: center;
        margin-bottom: 6rem;
        width: 100%;
      }
    </style>
    
    <!-- media queries -->
    <iron-media-query query="(max-width : 479px)" 
      query-matches="{{ mobileSmall }}"></iron-media-query>
    <iron-media-query query="(min-width : 480px) and (max-width : 767px)" 
      query-matches="{{ mobileMedium }}"></iron-media-query>
    <iron-media-query query="(min-width : 768px) and (max-width : 991px)"
      query-matches="{{ tablets }}"></iron-media-query>
    <iron-media-query query="(min-width : 992px) and (max-width : 1199px)" 
      query-matches="{{ desktopSmall }}"></iron-media-query>
    <iron-media-query query="(min-width : 1200px)" 
      query-matches="{{ desktopFull }}"></iron-media-query>
    
    <section class="section-multi container-fluid"
      style$="background-color: [[ multiData.multi_background_color ]];"
      mobile-small$="{{ mobileSmall }}"
      mobile-medium$="{{ mobileMedium }}"
      tablets$="{{ tablets }}"
      desktop-small$="{{ desktopSmall }}"
      desktop-full$="{{ desktopFull }}">

      <template
        is="dom-if"
        if="[[ multiData.multi_title ]]">
        <div class="row">
          <h2 class="col-xs-12 multi-title">[[ multiData.multi_title ]]</h2>
        </div>
      </template>

      <template
        is="dom-if"
        if="[[ multiData.multi_columns.length ]]">

      
        <template
          is="dom-if"
          if="[[ isFullWidth(multiData.multi_columns_container) ]]">
          <div class="row">
            <template
              is="dom-repeat"
              items="[[ multiData.multi_columns ]]"
              as="col">
              <template
                is="dom-if"
                if="[[ col.column_components.length ]]">

                <div class$="col-sm-{{ columnWidth }}">
                
                  <dorel-page-builder
                    builder-data="[[ col.column_components ]]"></dorel-page-builder>

                </div>

              </template>
            </template>
          </div>
        </template>


        <template
          is="dom-if"
          if="[[ !isFullWidth(multiData.multi_columns_container) ]]">
          <div class="row">
            <div class="container">
              <div class="row">
                <template
                  is="dom-repeat"
                  items="[[ multiData.multi_columns ]]"
                  as="col">
                  <template
                    is="dom-if"
                    if="[[ col.column_components.length ]]">

                    <div class$="col-sm-{{ columnWidth }}">
                    
                      <dorel-page-builder
                        builder-data="[[ col.column_components ]]"></dorel-page-builder>

                    </div>

                  </template>
                </template>
              </div>
            </div>
          </div>
        </template>

      </template>

    </section>
  </template>

  <script>

    Polymer({
      is: 'dorel-section-multi',

      properties: {

        /** 
         * @attribute
         * @name multiData
         * @description coming from the page-builder this data object is filled 
         * with ACF/Wordpress data about the component
         */
        multiData: {
          type: Object
        },

        /** 
         * @name columnAmount
         * @description defines the total columns the component needs to work with
         */
        columnAmount: {
          type: Number,
          value: 0,
          observer: '_defineColumnWidth'
        },

        /**
         * @name columnWidth
         * @description defines the width of one single column
         */
        columnWidth: {
          type: Number,
          value: 0
        }

      },

      /** 
       * @name ready
       * @description sets the column amount by the results in the array,
       * when the component is ready to use
       *
       */
      ready: function() {
        this.columnAmount = this.multiData.multi_columns.length;
      },

      /**
       * @name isFullWidth
       * @description check what type of container it is
       *
       * @returns Boolean if it is a full width container or not (true/false)
       */
      isFullWidth: function(container) {
        return (typeof container !== 'undefined' && container === 'full-width');
      },

      /**
       * @name _defineColumnWidth
       * @description calculate the column width of each column, depends
       * on the frontend framework's grid
       */
      _defineColumnWidth: function(newVal, oldVal) {
        this.columnWidth = 12 / this.columnAmount;
      },
    });

  </script>

</dom-module>