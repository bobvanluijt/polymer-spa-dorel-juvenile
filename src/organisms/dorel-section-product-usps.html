<link rel="import" href="../utils/dorel-magento-collect-custom-data.html">

<dom-module id="dorel-section-product-usps">
  <template>
    <style>

      :host {
        margin: 3em 0;
        float: left;
        width: 100%;
      }

      dorel-layout-row {
        margin-top: 0
      }

      .usp-title {
        @apply(--theme-typography-3);
        float: left;
        width: 100%;
      }

      .usp-description {
        float: left;
        margin: .75em 0;
      }

      .usp-image {
        width: 100%;
        float: left;
        height: 12em;
        border-radius: var(--theme-border-radius-1);
      }

      .usp-content {
        padding: 0 1em;
      }

      [tablet-medium-up] dorel-layout-row {
        margin-top: 1.5em;
      }

      [tablet-medium-up] .usp-description {
        padding-right: 1.5em;
      }

    </style>

    <dorel-magento-collect-custom-data
      product-id="[[ productId ]]"
      data="{{ uspsData }}"
      app-cache="[[ appCache ]]"
      type="usps"></dorel-magento-collect-custom-data>

    <dorel-media-query breakpoints="{{ breakpoints }}"></dorel-media-query>
    <dorel-layout-container tablet-medium-up$="{{ breakpoints.tabletMediumUp }}">
      <dorel-titling title="[[ uspsData.title ]]" description="[[ uspsData.description ]]"></dorel-titling>
      <template
        is="dom-if"
        if="[[ uspsData.usps.length ]]">
        <dorel-layout-row>
          <template
            is="dom-repeat"
            items="[[ uspsData.usps ]]"
            as="usp">
            <dorel-layout-column desktop-column-span="4" tablet-column-span="6" mobile-column-span="12">
              <div class="usp">
                <template
                  is="dom-if"
                  if="[[ _hasValue(usp.image) ]]">
                  <iron-image class="usp-image"
                              sizing="cover"
                              fade="true"
                              preload
                              src$="[[ usp.image ]]">
                  </iron-image>
                </template>

                <div class="usp-content">
                  <template
                    is="dom-if"
                    if="[[ _hasValue(usp.title) ]]">
                    <h3 class="usp-title">[[ usp.title ]]</h3>
                  </template>

                  <template
                    is="dom-if"
                    if="[[ _hasValue(usp.description) ]]">
                    <div class="usp-description">
                      <dorel-safe-html html="[[ usp.description ]]"></dorel-safe-html>
                    </div>
                  </template>
                </div>
              </div>
            </dorel-layout-column>

          </template>
        </dorel-layout-row>
      </template>
    </dorel-layout-container>


  </template>
  <script>
    Polymer({
      is: 'dorel-section-product-usps',
      properties: {

        productId: {
          type: Number
        },

        /**
         * @attribute
         * @name uspsData
         * @description coming from the page-builder this data object is filled
         * with ACF/Wordpress data about the component
         */
        uspsData: {
          type: Object
        },

        /**
         * @attribute
         * @name appCache
         * @description the temporary cache of the application,
         * contains data that used to be contained by the globalsManager
         */
        appCache: {
          type: Object
        }
      },

      behaviors: [ConditionalBehaviors]
    });
  </script>
</dom-module>
