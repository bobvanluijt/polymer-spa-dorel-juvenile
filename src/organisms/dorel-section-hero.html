<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../../bower_components/iron-media-query/iron-media-query.html">
<link rel="import" href="../molecules/dorel-card.html">

<dom-module id="dorel-section-hero">
  <template>
    <style include="iron-flex iron-flex-alignment">

      .section-hero {
        position: relative;
        height: 750px;
      }

      /**
      * Card layout
      */
      .pull-right, .pull-left {
        width: 50%;
        min-width: 500px;
        margin: auto;
      }

      .pull-right {
        margin-right: 0;
      }

      .pull-left {
        margin-left: 0;
      }

      .pull-left dorel-card {
        margin-top: -10%;
      }

      .section-hero-wrap dorel-card {
        @apply(--layout-horizontal);
        @apply(--layout-center);
      }

      /**
      * Hero image styling
      */
      .section-hero-wrap {
        padding: var(--theme-component-space-inner);
        width: calc(100% - 3rem);
        height: 100%;
        position: absolute;
        left: 0;
        top: 0;
        display: block;
        display: flex;
      }

      .section-hero-image-wrapper {
        transform: skewY(5deg);
        float: left;
        display: block;
        width: 100%;
        height: 750px;
        z-index: -1;

      }

      .section-hero-image {
        background-position: center center;
        background-repeat: no-repeat;
        background-size: cover;
        width: 100%;
        height: 110%;
        z-index: -1;
      }

      .section-hero:first-of-type {
        margin-top: 10%;
      }

      .section-hero:last-of-type {
        margin-bottom: -10%;
      }

      .section-hero:last-of-type .pull-left,  .section-hero:last-of-type .pull-right {
        padding-bottom: 10%;
      }

      /**
      * Responsive definitions
      */
      [mobile-small] .pull-right, [mobile-small] .pull-left,
      [mobile-medium] .pull-right, [mobile-medium] .pull-left {
        width: 100%;
        min-width: auto;
      }

    </style>
    
    <!-- media queries -->
    <iron-media-query query="(max-width : 479px)" 
      query-matches="{{ mobileSmall }}"></iron-media-query>
    <iron-media-query query="(min-width : 480px) and (max-width : 767px)" 
      query-matches="{{ mobileMedium }}"></iron-media-query>
    <iron-media-query query="(min-width : 768px) and (max-width : 991px)"
      query-matches="{{ tablets }}"></iron-media-query>
    <iron-media-query query="(min-width : 992px) and (max-width : 1199px)" 
      query-matches="{{ desktopSmall }}"></iron-media-query>
    <iron-media-query query="(min-width : 1200px)" 
      query-matches="{{ desktopFull }}"></iron-media-query>
    
    <section class="section-heroes"
      mobile-small$="{{ mobileSmall }}"
      mobile-medium$="{{ mobileMedium }}"
      tablets$="{{ tablets }}"
      desktop-small$="{{ desktopSmall }}"
      desktop-full$="{{ desktopFull }}">

      <template
        is="dom-repeat"
        items="[[ heroData.hero ]]"
        as="hero">
        <div class="section-hero">
          <div class="section-hero-image-wrapper">
            <div class="section-hero-image"
                 style$="background-image: url([[ hasBackgroundImage(hero.background_image) ]]);">
            </div>
          </div>
          <div class="section-hero-wrap">

            <template
              is="dom-if"
              if="[[ hero.card.length ]]">
                <div class$="pull-[[ hero.card_alignment ]]">
                  <template
                    is="dom-repeat"
                    items="[[ hero.card ]]"
                    as="card">
                    <dorel-card card-data="[[ card ]]" skewed></dorel-card>
                  </template>
                </div>
            </template>

          </div>
        </div>

      </template>
    </section>
  </template>
  <script>

    Polymer({
      is: 'dorel-section-hero',

      properties: {

        /**
         * @attribute
         * @name heroData
         * @description all info from the page-builder needed for the hero component
         */
        heroData: {
          type: Object,
          value: function() {
            return {};
          }
        }

      },

      /** 
       * @name hasBackgroundImage
       * @description checks if a background image is defined in Wordpress if not a placholder is used
       *
       * @returns String returns a placeholder url if nothing is set or the img url if it is
       */
      hasBackgroundImage: function(img) {
        return (typeof img === 'undefined' || img === '' || !img) ? '/assets/images/placeholders/hero/placeholder.jpg' : img;
      }
    });

  </script>

</dom-module>
