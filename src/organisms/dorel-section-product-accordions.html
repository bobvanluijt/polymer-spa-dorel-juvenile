<link rel="import" href="../../bower_components/iron-collapse/iron-collapse.html">
<link rel="import" href="../utils/dorel-magento-collect-custom-data.html">


<link rel="import" href="../atoms/dorel-accordion-item.html">

<link rel="import" href="../molecules/product-information/dorel-product-information-basic.html">
<link rel="import" href="../molecules/product-information/dorel-product-information-faq.html">
<link rel="import" href="../molecules/product-information/dorel-product-information-manuals.html">
<link rel="import" href="../molecules/product-information/dorel-product-information-specifications.html">

<dom-module id="dorel-section-product-accordions">
  <style>
    .extra-link {
      float: right;
      text-align: right;
      clear: both;
      padding-right: 1em;
    }
  </style>
  <template>
    <dorel-magento-collect-custom-data
      product-id="[[ productId ]]"
      app-cache="[[ appCache ]]"
      data="{{ accordionsData }}"
      type="accordions"></dorel-magento-collect-custom-data>

    <template
      is="dom-if"
      if="[[ accordionsData.accordions.length ]]">

      <dorel-layout-container>
        <dorel-layout-row align="center">
          <dorel-layout-column desktop-column-span="8" tablet-column-span="12" mobile-column-span="12">
            <div class="accordion">
              <template is="dom-repeat" items="[[ accordionsData.accordions ]]">
                <dorel-accordion-item heading="[[ item.heading ]]"
                                      gtm-parent="[[ gtmParent ]]"
                                      gtm-parent-index="[[ gtmParentIndex ]]" gtm-cta-index$="[[ index ]]">

                  <!-- Product Information Basic -->
                  <template is="dom-if" if="[[ _isPageComponent(item.type, 'basic') ]]">
                    <dorel-product-information-basic data="[[ item ]]"></dorel-product-information-basic>
                  </template>
                  <!--// Product Information Basic -->

                  <!-- Product Information FAQ -->
                  <template is="dom-if" if="[[ _isPageComponent(item.type, 'faq') ]]">
                    <dorel-product-information-faq data="[[ item ]]"></dorel-product-information-faq>
                  </template>
                  <!--// Product Information FAQ -->

                  <!-- Product Information Manuals -->
                  <template is="dom-if" if="[[ _isPageComponent(item.type, 'manuals') ]]">
                    <dorel-product-information-manuals data="[[ item ]]"></dorel-product-information-manuals>
                  </template>
                  <!--// Product Information Manuals -->

                  <!-- Product Information Specifications -->
                  <template is="dom-if" if="[[ _isPageComponent(item.type, 'specifications') ]]">
                    <dorel-product-information-specifications
                      data="[[ item ]]"></dorel-product-information-specifications>
                  </template>
                  <!--// Product Information Specifications -->

                  <!-- Extra link html -->
                  <template is="dom-if" if="[[ item.extra_link_html ]]">
                    <dorel-safe-html class="extra-link" html="[[ item.extra_link_html ]]"></dorel-safe-html>
                  </template>
                  <!-- Extra link html -->

                </dorel-accordion-item>
              </template>
            </div>
          </dorel-layout-column>
        </dorel-layout-row>
      </dorel-layout-container>
    </template>
  </template>
  <script>
    Polymer({
      is: 'dorel-section-product-accordions',
      behaviors: [PageBuilderBehavior],
      properties: {

        productId: {
          type: Number
        },

        /**
         * @attribute
         * @name accordionsData
         * @description coming from the page-builder this data object is filled
         * with ACF/Wordpress data about the component
         */
        accordionsData: {
          type: Object,
          value: function () {
            return {};
          }
        },

        /**
         * @attribute
         * @name appCache
         * @description the temporary cache of the application,
         * contains data that used to be contained by the globalsManager
         */
        appCache: {
          type: Object
        }
      },

      behaviors: [TemplateBehaviors]
    });
  </script>
</dom-module>
