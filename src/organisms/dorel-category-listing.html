<link rel="import" href="../molecules/dorel-category-listing-item.html">

<dom-module id="dorel-category-listing">
  <template>
    <style include="iron-flex iron-flex-alignment">
      :host {
        @apply(--max-width-container);
        width: 100%;
        margin: auto;
        float: none;
        display: block;
      }

      .category-listing {
        margin-left: 0;
        box-sizing: border-box;
        padding: 0 var(--theme-gutter-mobile) 1.5em var(--theme-gutter-mobile);
      }

      .row {
        @apply(--theme-grid-row);
        @apply(--layout-flex);
        @apply(--theme-grid-row-margins);
      }

      dorel-category-listing-item {
        @apply(--theme-grid-column);
        margin-top: 0;
        -ms-flex-preferred-size: 100%;
        flex-basis: 100%;
        max-width: 100%;
      }

      dorel-cta {
        width: auto;
        margin: auto;
      }

      /* Responsive behaviour */
      [tablet-medium-up] dorel-category-listing-item, [tablet-small] dorel-category-listing-item {
        -ms-flex-preferred-size: calc(var(--theme-column-width) * 6);
        flex-basis: calc(var(--theme-column-width) * 6);
        max-width: calc(var(--theme-column-width) * 6);

      }

      [desktop-small-up] dorel-category-listing-item {
        -ms-flex-preferred-size: calc(var(--theme-column-width) * 4);
        flex-basis: calc(var(--theme-column-width) * 4);
        max-width: calc(var(--theme-column-width) * 4);
      }

      [desktop-small-up] .category-listing {
        margin-left: calc(25% - .5em);
      }

      [tablet-medium-up] .category-listing {
        padding: 0 var(--theme-gutter) 1.5em var(--theme-gutter);
      }

      [tablet-medium-up] .row {
        @apply(--theme-grid-row-margins);
      }

    </style>

    <dorel-media-query breakpoints="{{ breakpoints }}"></dorel-media-query>

    <div tablet-small$="{{ breakpoints.tabletSmall }}"
         tablet-medium-up$="{{ breakpoints.tabletMediumUp }}"
         desktop-small-up$="{{ breakpoints.desktopSmallUp }}">

      <section class="category-listing layout horizontal center center-justified wrap">
        <div class="row narrow-row">
          <template is="dom-if" if="products.length">
          <template
            is="dom-repeat"
            items="[[ productsData ]]"
            as="product">

            <dorel-category-listing-item
              colors-data="[[ product.childProducts ]]"
              link-url="[[ product.url ]]"
              product-name="[[ product.name ]]"
              gtm-parent="[[ gtmParent ]]"
              gtm-parent-index="[[ gtmParentIndex ]]"
              gtm-child="dorel-category-listing-item"
              gtm-child-index="[[ index ]]"></dorel-category-listing-item>
          </template>
        </template>
        </div>
      </section>
    </div>
  </template>
  <script>
    Polymer({
      is: 'dorel-category-listing',

      properties: {

        /**
         * @attribute
         * @name productsData
         * @description the data coming from magento which is delegated
         */
        productsData: {
          type: Array,
          value: []
        },
      }
    });
  </script>

</dom-module>
