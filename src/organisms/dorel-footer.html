<dom-module id="dorel-footer">
  <template>
    <style include="iron-flex iron-flex-alignment polymer-bootstrap-min">
      /**
       * footer wrapper
       */
      footer {
        background-color: var(--theme-brand-color-royal-blue);
        padding: var(--theme-component-space-inner);
      }
      
      /**
       * copyright and footer-menu links
       */
      footer a,
      .footer-text {
        color: white;
        text-decoration: none;
        @apply(--theme-ie-bodycopy);
      }

      /**
       * footer headings
       */
      .footer-heading {
        margin-bottom: .5rem;
        @apply(--theme-bodycopy);
        color: var(--theme-brand-color);
        font-size: 1rem;
      }

      /**
       * footer copyright and disclaimer
       */
      .footer-disclaimer {
        margin-top: 1rem;
        margin-bottom: 1rem;
      }
      
      /** 
       * Social media(wrapper)
       */
      .footer-media-links {
        padding: var(--theme-component-space-inner);
      }
      .footer-media-link {
        text-align: center;
        padding: 3px 20px;
        font-size: 13px;
        white-space: nowrap;
      }
      .footer-media-link a span {
        line-height: 24px;
        margin-left: 8px;
      }
      
      /**
       * footer back to top
       */
      .footer-back-to-top {
        padding: 1rem 0 0;
      }

      /* lists not enumerated */
      .footer-menu {
        margin: 1em 0;
        padding-left: 40px;
      }
      .footer-menu ul {
        margin: 0;
        padding: 0;
      }
      .footer-menu li {
        padding-left: 0;
        list-style-type: none;
      }
      
      /**
       * MOBILE BREAKPOINT
       */
      footer[mobile] {}
      footer[mobile] .footer-media-link {
      }
      footer[mobile] .footer-media-link span {
        display: none;
      }
      footer[mobile] .footer-menu {
        padding: 0;
      }
      
      /**
       * LAYOUTWIDE BREAKPOINT
       */
      footer[layoutwide] .footer-info {
        @apply(--layout-horizontal);
      }

      footer[layoutwide] .footer-menu {
        @apply(--layout-flex);
      }

      footer[layoutwide] .footer-disclaimer {
        @apply(--layout-flex-3);
      }
    </style>

    <iron-media-query query="(min-width:601px)" query-matches="{{ isAtLeast800px }}"></iron-media-query>
    <iron-media-query query="(max-width:600px)" query-matches="{{ mobile }}"></iron-media-query>

    <footer mobile$="{{ mobile }}" layoutwide$="{{ isAtLeast800px }}">

      <!-- check if we need to show the social links -->
      <template 
        is="dom-if"
        if="[[ globals.Dorel.collect.options.footer_social_toggle ]]">

        <section class="footer-media-links">
          <div class="layout horizontal center center-justified">

            <template
              is="dom-if"
              if="[[ globals.Dorel.collect.options.footer_social_links.length ]]">
              
              <template
                is="dom-repeat"
                items="[[ globals.Dorel.collect.options.footer_social_links ]]"
                as="social_link">

                <a class="footer-media-link" href="[[ social_link.social_media_href ]]">
                  <iron-icon icon="social-iconset:[[ social_link.social_media_icon ]]" style="fill:rgb(0, 150, 195)"></iron-icon>
                  <span>[[ social_link.social_media_text ]]</span>
                </a>

              </template>

            </template>

            <template
              is="dom-if"
              if="[[ !globals.Dorel.collect.options.footer_social_links.length ]]">
              <span class="footer-text">Please define your footer social links in the admin area</span>
            </template>

          </div>
        </section>

      </template>

      <section id="footer-widget-area" class="footer-info">
        <div class="layout vertical footer-disclaimer">
          <span class="footer-text">
            <dorel-safe-html html="[[ globals.Dorel.collect.options.footer_copyright ]]"></dorel-safe-html>
          </span>
          <!--div><img width="200" src="../../assets/images/dorel.svg" alt="#" /></div-->
        </div>

        <!-- widget areas are inserted here -->
      </section>

      <section class="footer-back-to-top">
        <dorel-back-to-top></dorel-back-to-top>
      </section>

    </footer>

  </template>

  <script>
    Polymer({
      is: 'dorel-footer',

      properties: {
        footerWidgets: {
          type: Object,
          notify: true
        }
      },

      observers: [
        '_areasChanged(globals.Dorel.collect.widgetAreas.footer-widget-area)'
      ],

      _areasChanged: function(data) {
        var footerEl = this;

        // if no data is given jump out
        if (typeof data === 'undefined' || typeof data.widgets === 'undefined') {
          return;
        } else if (data.widgets.length) {

          /**
           * iterate over every widget inside the footer-widget-area
           * and append it to the footer-widget-area div
           */
          data.widgets.forEach(function(widget) {
            var footerColumn = document.createElement("div");
            footerColumn.className = 'footer-menu';
            footerColumn.innerHTML = widget.rendered;

            footerEl.$['footer-widget-area'].appendChild(footerColumn);
          });
        }

        this.footerWidgets = data;
      }
    });
  </script>
</dom-module>