<link rel="import" href="../../bower_components/l2t-paper-slider/l2t-paper-slider.html">


<dom-module id="dorel-section-slideshow">
  <template>
    <style is="custom-style">

      .section-slideshow {
        position: relative;
        float: left;
        width: 100%;
        margin-top: 1.5em;
        background-color: var(--theme-color-monochrome-2);
      }

      .section-slideshow .simple-slider {
        width: 100%;
      }

      .section-slideshow .simple-slider-slide {
        background-position: center center;
        background-repeat: no-repeat;
        background-size: cover;
        width: 100%;
      }

      l2t-paper-slider {
        --paper-slider-dot-container-styles: {
          background-color: rgba(154, 154, 154, .5);
          border-radius: 1em;
          bottom: 1.375em;
        };

        --paper-slide-dot-styles: {
          background-color: var(--theme-color-white);
          width: .75em;
          height: .75em;
          margin: .5em;
          border-style: none;
          border: 1px solid var(--theme-color-white);
        };

        --paper-slide-dot-selected: var(--theme-brand-color-1);

        --paper-slide-height: 33em;
      }

    </style>

    <template
      is="dom-if"
      if="[[ slideshowData.slides.length ]]">
      <section class$="section-slideshow {{ isFullWidth(slideshowData.width) }}">
        <!-- simple-slider -->
        <l2t-paper-slider class="simple-slider"
                          auto-progress
                          slide-duration="4"
                          total-slides="[[ slideshowData.slides.length ]]">
          <template
            is="dom-repeat"
            items="[[ slideshowData.slides ]]"
            as="slide">
            <paper-slide class="simple-slider-slide"
                         style$="background-image: url([[ hasBackgroundImage(slide.image) ]]);"></paper-slide>

          </template>
        </l2t-paper-slider>
      </section>

    </template>
  </template>

  <script>
    Polymer({
      is: 'dorel-section-slideshow',

      properties: {

        /**
         * @attribute
         * @name slideshowData
         * @description data coming from ACF/Wordpress to build up the component
         */
        slideshowData: {
          type: Object,
          value: function () {
            return {};
          }
        }

      },

      /**
       * @name isFullWidth
       * @description defines if the container is full-width or fixed-width
       *
       * @returns String if it is full width 'container-fluid' will be returned
       * otherwise it will be 'container'
       */
      isFullWidth: function (container) {
        return (typeof container === '' || container === 'undefined' || container === 'full-width') ? 'container-fluid' : 'container';
      },

      /**
       * @name hasBackgroundImage
       * @description checks to see if an image is set for the slide
       *
       * @returns String if it a background image is defined otherwise it returns
       * a placeholder url
       */
      hasBackgroundImage: function (bgImage) {
        return (typeof bgImage === 'undefined' || bgImage === '' || !bgImage) ? '/assets/images/placeholders/slideshow/placeholder.jpg' : bgImage;
      },

      /**
       * @name prevSlide
       * @description handles what should happen when the previous button is clicked
       */
      prevSlide: function (event) {

        // call the prev() function of simple-slider
        this.$$('simple-slider').prev();

        // track the event
        this._eventTracking(event, 'previous');

      },

      /**
       * @name nextSlide
       * @description handles what should happen when the next button is clicked
       */
      nextSlide: function (event) {

        // call the next() function of simple-slider
        this.$$('simple-slider').next();

        // track the event
        this._eventTracking(event, 'next');
      },

      /**
       * @name _eventTracking
       * @description this is for cta tracking only
       * more info http://bit.ly/2nb6I7G
       */
      _eventTracking: function (event, type) {

        /**
         * Tracking on click for cta
         */
        var event = {
          action: type,
          component: 'slideshow',
          element: Polymer.dom(event).localTarget,
          event: 'polymer_event'
        };

        this.fire('setAppCache', {value: event, path: 'events'});
      }
    });
  </script>
</dom-module>
