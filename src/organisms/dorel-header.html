<dom-module id="dorel-header">
  <template>
    <style is="custom-style" include="polymer-bootstrap-min theme-maxicosi-shared-styles iron-flex iron-flex-alignment">
      /* 
       * header-top
       * @description: header-top is the grey top bar that holds the mobile
       * menu button or support and cart buttons on desktop
       */
      .header-top {
        background-color: var(--theme-color-background-tertiary);
        padding: 5px;
      }
      .container-logo[screenSmall] {
        height: 140px;
      }
      .header-main {
        padding: var(--theme-component-space-inner);
      }
      .menu-spacing {
        margin-left: var(--theme-component-space-inner);
      }
      .mobile-menu-label {
        line-height: 2rem;
        font-size: var(--theme-size-ui);
        @apply --theme-ui;
      }
      .paper-icn-big {
        width: calc(32px + 15px); /* var(--theme-icon-size-big) */
        height: calc(32px + 15px); /* var(--theme-icon-size-big) */
      }
    </style>

    <!-- static beginning AND end media queries -->
    <!--iron-media-query query="(max-width : 479px)" 
      query-matches="{{ screenExtraSmall }}"></iron-media-query-->
    <iron-media-query query="(max-width : 767px)"
      query-matches="{{ screenSmall }}"></iron-media-query>
    <iron-media-query query="(min-width : 768px) and (max-width : 991px)"
      query-matches="{{ screenMedium }}"></iron-media-query>
    <iron-media-query query="(min-width : 992px) and (max-width : 1199px)" 
      query-matches="{{ desktopLarge }}"></iron-media-query>

    <!-- screen up media query's  -->
    <iron-media-query query="(min-width : 768px)"
      query-matches="{{ screenMediumUp }}"></iron-media-query>
    <iron-media-query query="(min-width : 992px)" 
      query-matches="{{ screenLargeUp }}"></iron-media-query>
    <!--iron-media-query query="(min-width : 1200px)" 
      query-matches="{{ screenExtraLargeUp }}"></iron-media-query-->

    <header>

      <template is="dom-if" if="{{ screenMediumUp }}">
        <div class="layout horizontal end-justified header-top">
          <dorel-list-utility></dorel-list-utility>
        </div>
      </template>

      <!-- only small screen header -->
      <template is="dom-if" if="{{ screenSmall }}">
        <div class="layout vertical">
          <div class="layout horizontal justified center header-top">
            <div>
              <paper-icon-button
                class="paper-icn-big"
                icon="menu"
                on-click="_toggleDrawer"
                aria-label="menu"
                style="">
              </paper-icon-button>
              <!--span class="mobile-menu-label">Menu</span-->
            </div>
            <div>
              <dorel-user-tools></dorel-user-tools>
            </div>
          </div>
          <div class="layout horizontal center-center container-logo" screenSmall$="{{screenSmall}}">
            <div>
              <a href="/" id="header-main-logo" aria-label="Maxi Cosi">
                <dorel-logo></dorel-logo>
              </a>
            </div>
          </div>
        </div>
      </template>

      <!-- only medium screen header -->
      <template is="dom-if" if="{{ screenMedium }}">
        <div class="layout vertical wrap">
          <div>
            <div class="layout horizontal justified header-main">
              <div>
                <a href="/" id="header-main-logo" aria-label="Maxi Cosi">
                  <dorel-logo></dorel-logo>
                </a>
              </div>
              <div class="horizontal layout center">
                <dorel-user-tools></dorel-user-tools>
              </div>
            </div><!-- END horizontal wrap --> 
          </div>
          <div>
            <dorel-navigation-main></dorel-navigation-main>
          </div>
        </div>
      </template>

      <!-- only large screen up header -->
      <template is="dom-if" if="{{ screenLargeUp }}">
        <div class="layout horizontal header-main">
          <div>
            <a href="/" id="header-main-logo" aria-label="Maxi Cosi">
              <dorel-logo></dorel-logo>
            </a>
          </div>
          <div class="flex layout horizontal center menu-spacing">
            <div>
              <dorel-navigation-main></dorel-navigation-main>
            </div>
          </div>
          <div class="layout horizontal center">
            <div>
              <dorel-user-tools></dorel-user-tools>
            </div>
          </div>
        </div>
      </template>

    </header>

    <!-- Lazy-create the drawer for small screen sizes. -->
    <template 
      is="dom-if" 
      if="[[ _shouldRenderDrawer ]]">
      <app-drawer opened="{{ drawerOpened }}" swipe-open tabindex="0">

        <div class="layout vertical">
          <div class="layout horizontal justified center header-top">
            <div>
              <paper-icon-button
                class="paper-icn-big"
                icon="close"
                on-click="_toggleDrawer"
                aria-label="close-menu"
                style="">
              </paper-icon-button>
            </div>
          </div>
          <div>
            <template 
              is="dom-if" 
              if="[[ globals.Dorel.collect.menus.main_menu.items.length ]]">
              <iron-selector role="navigation" class="drawer-list" 
                selected="[[ page ]]" 
                attr-for-selected="name">
                <paper-menu>

                  <template 
                    is="dom-repeat" 
                    items="{{ globals.Dorel.collect.menus.main_menu.items }}"
                    as="menuItem" 
                    initial-count="4">
                    <a href="#" title="#">
                      <paper-item>[[ menuItem.title ]]</paper-item>
                    </a>
                  </template>

                  <!-- if has submenu -->
                  <paper-submenu>
                    <paper-item class="menu-trigger">Item with submenu</paper-item>
                    <paper-menu class="menu-content">
                      <a href="#" title="#">
                        <paper-item>Submenu</paper-item>
                      </a>
                      <a href="#" title="#">
                        <paper-item>Submenu</paper-item>
                      </a>
                      <a href="#" title="#">
                        <paper-item>Submenu</paper-item>
                      </a>
                    </paper-menu>
                  </paper-submenu>

                  <paper-item>language selector</paper-item>
                  <paper-item>support</paper-item>
                </paper-menu>
              </iron-selector>
            </template>
          </div>
        </div>

      </app-drawer>
    </template>

    <!-- search dropdown -->
    <style>
      .section-search-drawer {
        background-color: var(--theme-brand-color);
      }
      .search-container {
        padding-top: var(--theme-component-space-inner);
        padding-bottom: var(--theme-component-space-inner);
      }
      .search-container[screenSmall] {
        width: 100%;
        padding-right: var(--theme-component-space-inner);
        padding-left: var(--theme-component-space-inner);
      }
      .search-container[screenMediumUp] {
        width: 50%;
      }
      .input-light {
        --paper-input-container-color: var(--theme-color-background-secondary); /* input text when not typing */
        --paper-input-container-underline: var(--theme-color-background-secondary); /* bottom border when not typing */

        --paper-input-container-input-color: white; /* input text when typing */
        --paper-input-container-focus-color: white; /* bottom border when typing */

        --paper-input-container-label-focus: {
          color: var(--theme-color-foreground-tertiary); /* floating label when typing */
        };
        --paper-input-container-label-floating: {
          color: var(--theme-color-foreground-tertiary); /* floating label when not typing, keep the same as --paper-input-container-label-focus */
        };
        
        --paper-input-container-underline: {
          color: yellow;
        }
      }
    </style>
    <section class="section-search-drawer" opened="{{ searchDrawerOpened }}">
      <div class="layout horizontal center-justified">

        <div class="search-container" screenMediumUp$="{{screenMediumUp}}" screenSmall$="{{screenSmall}}">
          <form is="iron-form" method="get" action="/">
            <paper-input id="search-website" class="input-light" label="Search the website"></paper-input>
            <paper-autocomplete-suggestions for="search-website" source="[[accounts]]"></paper-autocomplete-suggestions>
            <paper-button raised onclick="_nativeSubmit(event)">Submit</paper-button>
          </form>
        </div>

        <script>
          var states = [
            {"text": "Alabama", "value": "AL"},
            {"text": "Alaska", "value": "AK"},
            {"text": "American Samoa", "value": "AS"},
            {"text": "Arizona", "value": "AZ"}
          ];

          var autocompleteSuggestions = document.querySelector('paper-autocomplete-suggestions');

          // autocompleteSuggestions.source = states;

          // autocompleteSuggestions.addEventListener('autocomplete-selected', function () {
          //   var paperToast = document.querySelector('paper-toast');
          //   var selected = event.detail.text;
          //   paperToast.text = 'Selected: ' + selected;
          //   paperToast.show();
          // });

          </script>

      </div>
      <!--dorel-search-small></dorel-search-small-->
    </section>

  </template>

  <script>
    Polymer({
      is: 'dorel-header',

      properties: {
        loadComplete: {
          type: Boolean
        },

        page: {
          type: String
        },

        _shouldShowTabs: {
          computed: '_computeShouldShowTabs(page)'
        },

        _shouldRenderTabs: {
          computed: '_computeShouldRenderTabs(_shouldShowTabs, loadComplete)'
        },

        _shouldRenderDrawer: {
          computed: '_computeShouldRenderDrawer(loadComplete)'
        }
      },

      _toggleDrawer: function() {
        this.drawerOpened = !this.drawerOpened;
      },

      _computeShouldShowTabs: function(page) {
        return (typeof page !== 'undefined') && (!this.screenExtraSmall || !this.screenSmall);
      },

      _computeShouldRenderTabs: function(_shouldShowTabs, loadComplete) {
        return _shouldShowTabs && loadComplete;
      },

      _computeShouldRenderDrawer: function(loadComplete) {
        return loadComplete && (this.screenExtraSmall || this.screenSmall || this.screenMedium);
      },
    });
  </script>
</dom-module>