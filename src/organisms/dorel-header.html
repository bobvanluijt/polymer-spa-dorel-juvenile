<dom-module id="dorel-header">
  <template>
    <style is="custom-style" include="polymer-bootstrap-min theme-maxicosi-shared-styles iron-flex iron-flex-alignment">

      /* 
       * header-top
       * @description: header-top is the grey top bar that holds the mobile
       * menu button and support and cart buttons on desktop
       */
      .header-top {
        background-color: var(--theme-color-background-tertiary);
        padding: 5px;
      }

      /* 
       * screen small order:        
       *
      1. menu (in sidebar)
      2. user tools (right justified)
      3. logo (center aligned)
      */
      /*header[screenSmall] .header-logo-and-user-tools {
        order: 1;
      }*/
      header[screenSmall] .header-item-logo {
        order: 4;
        /* center the logo */
        @apply(--layout-horizontal);
        @apply(--layout-center-center);
      }
      header[screenSmall] .header-item-menu {
        order: 1;
      }
      header[screenSmall] .header-item-user-tools {
        order: 2;
      }
      header[screenSmall] .header-item-search-drawer {
        order: 3;
      }
      header[screenSmall] .header-items {
        @apply(--layout-vertical);
        @apply(--layout-end-justified);
      }
      header[screenSmall] dorel-user-tools {
        background-color: var(--theme-color-background-tertiary);
        padding: 5px;
        @apply(--layout-horizontal);
        @apply(--layout-justified);
      }

      /* 
       * screen medium order:        
       *
      1. logo (left aligned)
      2. user tools(right justified)
      3. menu (full width)
      */
      header[screenMedium] .header-items {
        @apply(--layout-horizontal);
        @apply(--layout-center);
        @apply(--layout-wrap);
        @apply(--layout-around-justified);
      }
      header[screenMedium] .header-item-logo {
        order: 1;
      }
      header[screenMedium] .header-item-menu {
        @apply(--layout-wrap);
        order: 4;
      }
      header[screenMedium] .header-item-user-tools {
        @apply(--layout-wrap);
        order: 2;
      }
      header[screenMedium] .header-item-search-drawer {
        order: 3;
      }

      /* 
       * screen medium up:
       */
      header[screenMediumUp] .header-item-search-drawer {
        width: 100%;
      }

      /* 
       * screen large up order:
       *
      1. logo (left aligned)
      2. menu (stacked left)
      3. user tools (right justified)
      */

      header[screenLargeUp] .header-items {
        /* layout horizontal header-main */
        @apply(--layout-horizontal);
        @apply(--layout-justified);
        @apply(--layout-wrap);
        @apply(--layout-center);
      }
      header[screenLargeUp] .header-contain-main-elements {
        @apply(--layout-horizontal);
        @apply(--layout-justified);
      }

      /* spacing in menu */
      .header-item-logo,
      header[screenMediumUp] .header-item-user-tools {
        padding: var(--theme-component-space-inner);
      }
    </style>

    <!-- static beginning AND end media queries -->
    <!--iron-media-query query="(max-width : 479px)" 
      query-matches="{{ screenExtraSmall }}"></iron-media-query-->
    <iron-media-query query="(max-width : 767px)"
      query-matches="{{ screenSmall }}"></iron-media-query>
    <iron-media-query query="(min-width : 768px) and (max-width : 991px)"
      query-matches="{{ screenMedium }}"></iron-media-query>
    <iron-media-query query="(min-width : 992px) and (max-width : 1199px)" 
      query-matches="{{ desktopLarge }}"></iron-media-query>

    <!-- screen up media query's  -->
    <iron-media-query query="(min-width : 768px)"
      query-matches="{{ screenMediumUp }}"></iron-media-query>
    <iron-media-query query="(min-width : 992px)" 
      query-matches="{{ screenLargeUp }}"></iron-media-query>
    <!--iron-media-query query="(min-width : 1200px)" 
      query-matches="{{ screenExtraLargeUp }}"></iron-media-query-->

    <header 
      screenSmall$="{{ screenSmall }}"
      screenMedium$="{{ screenMedium }}"
      screenMediumUp$="{{ screenMediumUp }}"
      screenLargeUp$="{{ screenLargeUp }}">

      <template is="dom-if" if="{{ screenMediumUp }}">
        <div class="layout horizontal end-justified header-top">
          <dorel-list-utility></dorel-list-utility>
        </div>
      </template>

      <div class="header-items">

        <div class="header-item header-item-logo">
          <div>
            <a href="/" aria-label="Maxi Cosi"
              on-click="logoClicked">
              <dorel-logo></dorel-logo>
            </a>
          </div>
        </div>

        <div class="header-item header-item-menu">
          <dorel-navigation-main
            search-opened="{{ searchOpened }}"
            sub-menu-opened="{{ subMenuOpened }}"
            mobile-menu-opened="{{ mobileMenuOpened }}"></dorel-navigation-main>
        </div>

        <div class="header-item header-item-user-tools">
          <dorel-user-tools 
            search-opened="{{ searchOpened }}" 
            sub-menu-opened="{{ subMenuOpened }}"
            mobile-menu-opened="{{ mobileMenuOpened }}"></dorel-user-tools>
        </div>
        
        <div class="header-item header-item-search-drawer">
          <dorel-search-drawer 
            search-opened="{{ searchOpened }}"
            sub-menu-opened="{{ subMenuOpened }}"
            mobile-menu-opened="{{ mobileMenuOpened }}"></dorel-search-drawer>
        </div>

      </div>

    </header>

  </template>

  <script>
    Polymer({
      is: 'dorel-header',

      properties: {

        /**
         * @attribute
         * @name loadComplete
         * @description is set within the dorel-app when all info is loaded
         */
        loadComplete: {
          type: Boolean
        },
        
        /**
         * @attribute
         * @name page
         * @description defines the current page in string format
         */
        page: {
          type: String
        },

        /**
         * @exposed
         * @name searchOpened
         * @description defines if the search area should be opened or closed
         */
        searchOpened: {
          type: Boolean
        },

        /**
         * @exposed
         * @name submenuOpened
         * @description defines if one of the submenu's should be opened or closed
         */
        submenuOpened: {
          type: Boolean
        },

        
        /**
         * @exposed
         * @name mobileMenuOpened
         * @description defines if the mobile menu (drawer) should be opened or closed
         */
        mobileMenuOpened: {
          type: Boolean
        }
      },

      /**
       * @name logoClicked
       * @description handle the clicks on the logo
       */
      logoClicked: function(event) {

        // track this event
        this._eventTracking(event);

      },

      /**
       * @name _eventTracking
       * @description sets the right properties for event tracking
       */
      _eventTracking: function(event) {

        Polymer.globalsManager.set('Dorel.events', {
          action: 'switch',
          component: 'logo',
          element: Polymer.dom(event).localTarget.parentNode, // needs to be parentNode!!!!!
          event: 'polymer_event',
          things: {
            'currentPage': document.URL,
            'targetPage': Polymer.dom(event).localTarget.parentNode.href // needs to be parentNode!!!!!
          }
        });
        
      }
    });
  </script>
</dom-module>