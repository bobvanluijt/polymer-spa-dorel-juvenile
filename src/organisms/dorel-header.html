<dom-module id="dorel-header">
  <template>
    <style include="polymer-bootstrap-min theme-maxicosi-shared-styles iron-flex iron-flex-alignment iron-flex-layout">

      /* Refactor the following: */
      app-header {
        @apply(--layout-fixed-top);
        z-index: 1;
        background-color: rgba(255, 255, 255, 0.95);
        --app-header-shadow: {
          box-shadow: inset 0px 5px 6px -3px rgba(0, 0, 0, 0.2);
          height: 10px;
          bottom: -10px;
        };
      }
      app-drawer {
        z-index: 100;
      }
      dorel-tabs {
        float: left;
        height: 100%;
      }
      dorel-tab {
        --dorel-tab-overlay: {
          color: red;
        };
      }
      dorel-tab {
        margin: 0 10px;
      }
      dorel-tab a {
        text-decoration: none;
        outline: none;
        padding: 9px 5px;
        color: var(--theme-primary-text-color);
        @apply(--theme-ui);
      }

      /* 
       * header-top
       * @description: header-top is the grey top bar that holds the mobile
       * menu button or support and cart buttons on desktop
       */
      #header-top {
        background-color: #E6E6E6;
        padding: 5px;
        position: relative;
        float: left;
        width: 100%;
      }
      #header-top #header-top-menu .menu-btn,
      #header-top #header-top-menu .menu-text {
        float: left;
        position: relative;
      }
      #header-top #header-top-menu .menu-text {
        padding: 11px 0 0 0;
        font-size: .8rem;
      }

      #header-top #header-top-utilities {
        float: right;
        position: relative;
        margin: 0;
      }
      #header-top #header-top-utilities .list-group-item {
        background-color: transparent;
        border: 0;
        border-radius: 0;
        float: left;
        padding: 0;
        position: relative;
      }
      
      /** 
       *
       */
      #header-main {
        width: 100%;
      }
      #header-main #header-main-logo,
      /*#header-main #header-main-menu*/ {
        position: relative;
      }
      #header-main #header-main-logo {
        display: block;
        width: 100%;
        max-width: 330px;
      }
      #header-main #header-main-utility {
        padding: 35px 0;
      }
      header[mobile-small],
      header[mobile-medium] {
        text-align: center;
      }
      header[mobile-small] #header-main-logo,
      header[mobile-medium] #header-main-logo {
        margin: 0 auto;
      }
      header[screenMedium] #header-main-logo {
        float: left;
      }
      header[screenMedium] #header-main-menu {
        float: left;
        border-top: 2px solid #D8D8D8;
        padding: 20px 0px;
        width: 100%;
      }
      header[desktop-small] #header-main-logo,
      header[desktop-full] #header-main-logo {
        float: left;
      }
    </style>

    <!-- static beginning AND end media queries -->
    <!--iron-media-query query="(max-width : 479px)" 
      query-matches="{{ screenExtraSmall }}"></iron-media-query-->
    <iron-media-query query="(max-width : 767px)"
      query-matches="{{ screenSmall }}"></iron-media-query>
    <iron-media-query query="(min-width : 768px) and (max-width : 991px)"
      query-matches="{{ screenMedium }}"></iron-media-query>
    <iron-media-query query="(min-width : 992px) and (max-width : 1199px)" 
      query-matches="{{ desktopLarge }}"></iron-media-query>

    <!-- screen up media query's  -->
    <iron-media-query query="(min-width : 768px)"
      query-matches="{{ screenMediumUp }}"></iron-media-query>
    <iron-media-query query="(min-width : 992px)" 
      query-matches="{{ screenLargeUp }}"></iron-media-query>
    <!--iron-media-query query="(min-width : 1200px)" 
      query-matches="{{ screenExtraLargeUp }}"></iron-media-query-->

    <header>

      <template is="dom-if" if="{{ screenMediumUp }}">
        <div class="layout vertical">
          <dorel-list-utility></dorel-list-utility>
        </div>
      </template>

      <!-- only small screen header -->
      <template is="dom-if" if="{{ screenSmall }}">
        <div class="layout vertical wrap">
          <div id="header-top-menu">
            <paper-icon-button
                class="menu-btn"
                icon="menu"
                on-click="_toggleDrawer"
                aria-label="menu">
            </paper-icon-button>
            <span class="menu-text">Menu</span>
          </div>
          <a href="/" id="header-main-logo" aria-label="Maxi Cosi">
            <dorel-logo></dorel-logo>
          </a>
        </div>
      </template>

      <!-- only medium screen header -->
      <template is="dom-if" if="{{ screenMedium }}">
        <div class="layout vertical wrap">
          <div>
            <div class="layout horizontal justified">
              <div>
                <a href="/" id="header-main-logo" aria-label="Maxi Cosi">
                  <dorel-logo></dorel-logo>
                </a>
              </div>
              <div class="horizontal layout center">
                <dorel-user-tools></dorel-user-tools>
              </div>
            </div><!-- END horizontal wrap --> 
          </div>
          <div>
            <dorel-navigation-main></dorel-navigation-main>
          </div>
        </div>
      </template>

      <!-- only large screen up header -->
      <template is="dom-if" if="{{ screenLargeUp }}">
        <div class="layout horizontal">
          <div>
            <a href="/" id="header-main-logo" aria-label="Maxi Cosi">
              <dorel-logo></dorel-logo>
            </a>
          </div>
          <div class="flex layout horizontal center">
            <div>
              <dorel-navigation-main></dorel-navigation-main>
            </div>
          </div>
          <div class="layout horizontal center">
            <div>
              <dorel-user-tools></dorel-user-tools>
            </div>
          </div>
        </div>
      </template>

    </header>

    <!-- Lazy-create the drawer for small screen sizes. -->
    <template 
      is="dom-if" 
      if="[[ _shouldRenderDrawer ]]">
      <app-drawer opened="{{ drawerOpened }}" swipe-open tabindex="0">

        <template 
          is="dom-if" 
          if="[[ globals.Dorel.collect.menus.main_menu.items.length ]]">

          <iron-selector role="navigation" class="drawer-list" 
            selected="[[ page ]]" 
            attr-for-selected="name">
          
            <template 
              is="dom-repeat" 
              items="{{ globals.Dorel.collect.menus.main_menu.items }}"
              as="menuItem" 
              initial-count="4">
              <a href="[[ menuItem.url ]]">[[ menuItem.title ]]</a>
            </template>

            <ul>
              <li>Menu item 1</li>
              <li>Menu item 2</li>
              <li>Menu item 3</li>
              <li>Menu item 4</li>
            </ul>

            <ul>
              <li>language selector</li>
              <li>support</li>
            </ul>

          </iron-selector>

        </template>
      </app-drawer>
    </template>

    <!-- search dropdown -->
    <section class="header-search vertical-center">
      <p>Make search dropdown section here</p>
      <!--dorel-search-small></dorel-search-small-->
    </section>

  </template>

  <script>
    Polymer({
      is: 'dorel-header',

      properties: {
        loadComplete: {
          type: Boolean
        },

        page: {
          type: String
        },

        _shouldShowTabs: {
          computed: '_computeShouldShowTabs(page)'
        },

        _shouldRenderTabs: {
          computed: '_computeShouldRenderTabs(_shouldShowTabs, loadComplete)'
        },

        _shouldRenderDrawer: {
          computed: '_computeShouldRenderDrawer(loadComplete)'
        }
      },

      _toggleDrawer: function() {
        this.drawerOpened = !this.drawerOpened;
      },

      _computeShouldShowTabs: function(page) {
        return (typeof page !== 'undefined') && (!this.screenExtraSmall || !this.screenSmall);
      },

      _computeShouldRenderTabs: function(_shouldShowTabs, loadComplete) {
        return _shouldShowTabs && loadComplete;
      },

      _computeShouldRenderDrawer: function(loadComplete) {
        return loadComplete && (this.screenExtraSmall || this.screenSmall || this.screenMedium);
      },
    });
  </script>
</dom-module>