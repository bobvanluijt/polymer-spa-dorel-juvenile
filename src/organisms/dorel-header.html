<dom-module id="dorel-header">
  <template>
    <style is="custom-style" include="polymer-bootstrap-min theme-maxicosi-shared-styles iron-flex iron-flex-alignment">

      .header-item-logo {
        padding: var(--theme-component-space-inner);
      }

      /* 
       * screen small order:        
       *
      1. menu (in sidebar)
      2. user tools (right justified)
      3. logo (center aligned)
      */
      /*header[screenSmall] .header-logo-and-user-tools {
        order: 1;
      }*/
      header[screenSmall] .header-item-logo {
        order: 4;
        /* center the logo */
        @apply(--layout-horizontal);
        @apply(--layout-center-center);
      }
      header[screenSmall] .header-item-menu {
        order: 1;
      }
      header[screenSmall] .header-item-user-tools {
        order: 2;
      }
      header[screenSmall] .header-item-search-drawer {
        order: 3;
      }
      header[screenSmall] .header-items {
        @apply(--layout-vertical);
        @apply(--layout-end-justified);
      }
      header[screenSmall] dorel-user-tools {
        background-color: var(--theme-color-background-tertiary);
        padding: 5px;
        @apply(--layout-horizontal);
        @apply(--layout-justified);
      }

      /* 
       * screen medium order:        
       *
      1. logo (left aligned)
      2. user tools(right justified)
      3. menu (full width)
      */
      header[screenMedium] .header-items {
        @apply(--layout-horizontal);
        @apply(--layout-center);
        @apply(--layout-wrap);
        @apply(--layout-around-justified);
      }
      /*header[screenMedium] .header-item-logo {  }*/
      header[screenMedium] .header-item-menu {
        @apply(--layout-wrap);
      }
      header[screenMedium] .header-item-user-tools {
        @apply(--layout-wrap);
      }
      /* 
       * screen medium up:
       */
      header[screenMediumUp] .header-item-search-drawer {
        width: 100%;
        /*@apply(--layout-flex);*/
      }

      /* 
       * screen large up order:
       *
      1. logo (left aligned)
      2. menu (stacked left)
      3. user tools (right justified)
      */

      header[screenLargeUp] .header-items {
        /* layout horizontal header-main */
        @apply(--layout-horizontal);
        @apply(--layout-justified);
        @apply(--layout-wrap);
        @apply(--layout-center);
      }
      header[screenLargeUp] .header-contain-main-elements {
        @apply(--layout-horizontal);
        @apply(--layout-justified);
      }

      /* 
       * header-top
       * @description: header-top is the grey top bar that holds the mobile
       * menu button or support and cart buttons on desktop
       */
      .header-top {
        background-color: var(--theme-color-background-tertiary);
        padding: 5px;
      }
      .container-logo[screenSmall] {
        height: 140px;
      }
      .menu-spacing {
        margin-left: var(--theme-component-space-inner);
      }
      .mobile-menu-label {
        line-height: 2rem;
        font-size: var(--theme-size-ui);
        @apply --theme-ui;
      }
      .paper-icn-big {
        width: calc(32px + 15px); /* var(--theme-icon-size-big) */
        height: calc(32px + 15px); /* var(--theme-icon-size-big) */
      }
      paper-submenu .menu-content {
        background-color: var(--theme-color-background-tertiary);
      }
    </style>

    <!-- static beginning AND end media queries -->
    <!--iron-media-query query="(max-width : 479px)" 
      query-matches="{{ screenExtraSmall }}"></iron-media-query-->
    <iron-media-query query="(max-width : 767px)"
      query-matches="{{ screenSmall }}"></iron-media-query>
    <iron-media-query query="(min-width : 768px) and (max-width : 991px)"
      query-matches="{{ screenMedium }}"></iron-media-query>
    <iron-media-query query="(min-width : 992px) and (max-width : 1199px)" 
      query-matches="{{ desktopLarge }}"></iron-media-query>

    <!-- screen up media query's  -->
    <iron-media-query query="(min-width : 768px)"
      query-matches="{{ screenMediumUp }}"></iron-media-query>
    <iron-media-query query="(min-width : 992px)" 
      query-matches="{{ screenLargeUp }}"></iron-media-query>
    <!--iron-media-query query="(min-width : 1200px)" 
      query-matches="{{ screenExtraLargeUp }}"></iron-media-query-->

    <header 
      screenSmall$="{{ screenSmall }}"
      screenMedium$="{{ screenMedium }}"
      screenMediumUp$="{{ screenMediumUp }}"
      screenLargeUp$="{{ screenLargeUp }}">

      <template is="dom-if" if="{{ screenMediumUp }}">
        <div class="layout horizontal end-justified header-top">
          <dorel-list-utility></dorel-list-utility>
        </div>
      </template>

      <div class="header-items">

        <div class="header-item header-item-logo">
          <div>
            <a href="/" id="header-main-logo" aria-label="Maxi Cosi">
              <dorel-logo></dorel-logo>
            </a>
          </div>
        </div>

        <div class="header-item header-item-menu">
          <dorel-navigation-main mobile-menu-opened="{{ mobileMenuOpened }}"></dorel-navigation-main>
        </div>

        <div class="header-item header-item-user-tools">
          <dorel-user-tools 
            search-opened="{{ searchOpened }}" 
            mobile-menu-opened="{{ mobileMenuOpened }}"></dorel-user-tools>
        </div>

        <div class="header-item header-item-search-drawer">
          <dorel-search-drawer search-opened="{{ searchOpened }}"></dorel-search-drawer>
        </div>

      </div>

    </header>

  </template>

  <script>
    Polymer({
      is: 'dorel-header',

      properties: {
        loadComplete: {
          type: Boolean
        },

        /** 
         * Variable gets exposed by the dorel-user-tools, 
         * and is exposed in the dorel-header and piped through to the search-drawer
         */
        searchOpened: {
          type: Boolean,
        },

        page: {
          type: String
        },

        submenuOpened: {
          type: Boolean
        },

        /** 
         * Variable gets exposed by the dorel-user-tools, 
         * and is exposed in the dorel-header and piped through to the dorel-navigation-main
         * 
         */
        mobileMenuOpened: {
          type: Boolean
        },

        states: {
          type: Array,
          value: [
            {"text": "Alabama", "value": "AL"},
            {"text": "Alaska", "value": "AK"},
            {"text": "American Samoa", "value": "AS"},
            {"text": "Arizona", "value": "AZ"}
          ]
        },

      },

      _toggleSubmenuIcon: function(e) {

        // toggle the var that needs to be exposed to the host
        this.subMenuOpened = !this.subMenuOpened;

        // define icon variable needed for setting the attribute
        var iconAttr = (this.subMenuOpened) ? 'dorel-icons:expand-less' : 'dorel-icons:expand-more';

        // also change icon when icon itself is clicked
        // then set attribute
        if (Polymer.dom(e).rootTarget.classList.contains('menu-trigger-icon')) {
          Polymer.dom(e).rootTarget.setAttribute('icon', iconAttr);
        } else {
          Polymer.dom(e).rootTarget.querySelector('.menu-trigger-icon').setAttribute('icon', iconAttr);
        }

      },

    });
  </script>
</dom-module>