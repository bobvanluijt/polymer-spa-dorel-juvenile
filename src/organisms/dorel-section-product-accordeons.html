<link rel="import" href="../../node_modules/iron-collapse/iron-collapse.html">
<link rel="import" href="../utils/dorel-magento-collect-custom-data.html">


<link rel="import" href="../atoms/dorel-accordeon-item.html">

<link rel="import" href="../molecules/product-information/dorel-product-information-topic.html">
<link rel="import" href="../molecules/product-information/dorel-product-information-faq.html">
<link rel="import" href="../molecules/product-information/dorel-product-information-manuals.html">
<link rel="import" href="../molecules/product-information/dorel-product-information-specifications.html">

<dom-module id="dorel-section-product-accordeons">
  <template>
    <style>
      h1, h2, h3, h4 {
        @apply(--theme-header-text-transform);
      }

      dorel-layout-container {
        padding: 1.5em 0;
        float: left;
        width: 100%;
      }

      dorel-layout-container[tablet-medium-up] {
        padding: 3em 0;
      }
    </style>
    <dorel-magento-collect-custom-data
      product-id="[[ productId ]]"
      app-cache="[[ appCache ]]"
      data="{{ accordeonsData }}"
      type="accordeons"></dorel-magento-collect-custom-data>

    <template
      is="dom-if"
      if="[[ accordeonsData.accordions.length ]]">

      <dorel-media-query breakpoints="{{ breakpoints }}"></dorel-media-query>

      <dorel-layout-container tablet-medium-up$="[[ breakpoints.tabletMediumUp ]]">
        <dorel-layout-row align="center">
          <dorel-layout-column desktop-column-span="8" tablet-column-span="12" mobile-column-span="12">
            <div class="accordeon">
              <template is="dom-repeat" items="[[ accordeonsData.accordions ]]">
                <dorel-accordeon-item heading="[[ item.heading ]]"
                                      gtm-parent="[[ gtmParent ]]"
                                      gtm-parent-index="[[ gtmParentIndex ]]" gtm-cta-index$="[[ index ]]">

                  <!-- Product Information Basic -->
                  <template is="dom-if" if="[[ _isPageComponent(item.accordeon_type, 'topic') ]]">
                    <dorel-product-information-topic data="[[ item ]]"></dorel-product-information-topic>
                  </template>
                  <!--// Product Information Basic -->

                  <!-- Product Information FAQ -->
                  <template is="dom-if" if="[[ _isPageComponent(item.accordeon_type, 'faq') ]]">
                    <dorel-product-information-faq data="[[ item ]]"></dorel-product-information-faq>
                  </template>
                  <!--// Product Information FAQ -->

                  <!-- Product Information Manuals -->
                  <template is="dom-if" if="[[ _isPageComponent(item.accordeon_type, 'manuals') ]]">
                    <dorel-product-information-manuals data="[[ item ]]"></dorel-product-information-manuals>
                  </template>
                  <!--// Product Information Manuals -->

                  <!-- Product Information Specifications -->
                  <template is="dom-if" if="[[ _isPageComponent(item.accordeon_type, 'specifications') ]]">
                    <dorel-product-information-specifications
                      data="[[ item ]]"></dorel-product-information-specifications>
                  </template>
                  <!--// Product Information Specifications -->
                </dorel-accordeon-item>
              </template>
            </div>
          </dorel-layout-column>
        </dorel-layout-row>
      </dorel-layout-container>
    </template>
  </template>
  <script>
    Polymer({
      is: 'dorel-section-product-accordeons',
      behaviors: [PageBuilderBehavior],
      properties: {

        productId: {
          type: Number
        },

        /**
         * @attribute
         * @name accordeonsData
         * @description coming from the page-builder this data object is filled
         * with ACF/Wordpress data about the component
         */
        accordeonsData: {
          type: Object,
          value: function () {
            return {};
          }
        },

        /**
         * @attribute
         * @name appCache
         * @description the temporary cache of the application,
         * contains data that used to be contained by the globalsManager
         */
        appCache: {
          type: Object
        }
      },

      behaviors: [TemplateBehaviors]
    });
  </script>
</dom-module>
