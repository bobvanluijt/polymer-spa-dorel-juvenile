<link rel="import" href="../organisms/dorel-category-listing.html">

<dom-module id="dorel-template-product-category">
  <template>
    <style>
      :root {
        /* Override the default background-color for the multi sections */
        --theme-multi-background-color: var(--theme-color-background-tertiary);
        --theme-multi-no-background-color: transparent;
        --theme-multi-bottom-padding: var(--theme-component-space-inner-xlarge);
        float: left;
        width: 100%;
      }

      .wrapper {
        opacity: 0; /* make things invisible upon start */
        -webkit-animation: fadeIn ease 1; /* call our keyframe named fadeIn, use animattion ease-in and repeat it only 1 time */
        -moz-animation: fadeIn ease 1;
        animation: fadeIn ease 1;
        -webkit-animation-duration: 1s;
        -moz-animation-duration: .1s;
        animation-duration: 1s;
        -webkit-animation-fill-mode: forwards; /* this makes sure that after animation is done we remain at the last keyframe value (opacity: 1)*/
        -moz-animation-fill-mode: forwards;
        animation-fill-mode: forwards;
      }

      @-webkit-keyframes fadeIn {
        from {
          opacity: 0;
          opacity: 1 \9; /* IE9 only */
        }
        to {
          opacity: 1;
        }
      }

      @-moz-keyframes fadeIn {
        from {
          opacity: 0;
          opacity: 1 \9; /* IE9 only */
        }
        to {
          opacity: 1;
        }
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          opacity: 1 \9; /* IE9 only */
        }
        to {
          opacity: 1;
        }
      }

      dorel-layout-section dorel-page-builder {
        width: 100%;
        display: flex;
      }
    </style>

    <iron-ajax
      auto
      url="[[ categoriesEndPoint ]]"
      handle-as="json"
      on-response="_categoriesLoaded"></iron-ajax>

    <div class="wrapper">
      ---category----
      <!-- show when acf.page_builder has components -->
      <template
        is="dom-if"
        if="{{ templateData.page_builder.length }}">

        <!-- iterate over page_builder components -->
        <template
          is="dom-repeat"
          items="[[ builderData.acf.page_builder ]]"
          as="component"
          targetFramerate="1000">

          <dorel-category-listing></dorel-category-listing>

        </template>

      </template>

    </div>

  </template>

  <script>
    Polymer({
      is: 'dorel-template-product-category',

      properties: {

        /**
         * @attribute
         * @name templateData
         * @description the data coming from ACF/Wordpress which is delegated to the page builder
         */
        templateData: {
          type: String
        }
      },

      ready: function() {
        var globals = Polymer.globalsManager.get('Dorel');
        var self = this;

        var category = globals.collect.categories.find(function(category) {
          return category.id === self.templateData.acf.product_category[0];
        });

        console.log(category);
      }

    });
  </script>
</dom-module>
