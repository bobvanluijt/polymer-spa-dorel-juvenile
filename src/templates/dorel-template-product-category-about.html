<link rel="import" href="../organisms/dorel-section-category-about-header.html">
<link rel="import" href="../organisms/dorel-section-category-about-sub-categories.html">

<dom-module id="dorel-template-product-category-about">
  <template>
    <style>
      dorel-section-page-nav {
        width: 100%;
      }
    </style>

    <div tablet-medium-up$="{{ breakpoints.tabletMediumUp }}"
         desktop-small-up$="{{ breakpoints.desktopSmallUp }}">
          
      <!-- category-about-header -->
      <template
        is="dom-if"
        if="[[templateData.acf.hero_header.length]]"> 
        <dorel-section-category-about-header
          template-data="[[heroHeaderData]]"></dorel-section-category-about-header>
          
          <!-- page-nav -->
          <dorel-section-page-nav
            breadcrumbs-toggle="true"></dorel-section-page-nav>
          <!--// page-nav -->

      </template>
      <!--// category-about-header -->

      <!-- about cards -->
      <template
        is="dom-if"
        if="[[templateData.acf.about_cards.length]]">
        <dorel-section-cards 
          cards-data="[[aboutCards]]"
          cta-type="secondary" 
          compact="true"></dorel-section-cards>
      </template>
      <!--// about cards -->

      <!-- category-about-sub-categories -->
      <template
        is="dom-if"
        if="[[templateData.acf.about_sub_categories.length]]"> 
        <dorel-section-category-about-sub-categories
          template-data="[[aboutSubCategories]]"></dorel-section-category-about-sub-categories>
      </template>
      <!--// category-about-sub-categories -->

  </template>

  <script>
    Polymer({
      is: 'dorel-template-product-category-about',

      properties: {

        /**
         * @attribute
         * @name templateData
         * @description the data coming from ACF/Wordpress which is delegated to the page builder
         */
        templateData: {
          type: Object,
          value: function() {
            return {};
          },
          observer: '_defineComponentModels'
        },

        /**
         * @name homeHeaderData
         * @description the data model used for the hero header component
         */
        heroHeaderData: Object,

        /**
         * @name aboutSubCategories
         * @description the data model used for the about sub categories component
         */
        aboutSubCategories: Object,

        /**
         * @name aboutCards
         * @description the data model used for the about cards component
         */
        aboutCards: Object
      },

      /**
       * @name _defineComponentModels
       * @description Fixed WP/ACF data is defined by an array (workaround). For components
       * that always have one item in the array a new data model is created to be set on
       * component attribute level. Binding with [0] array item selector doesn't work.
       *
       * @param Object
       */
      _defineComponentModels: function(templateData) {
        // check if the templateData has content
        if(!this._hasProperty(templateData) || typeof templateData.acf === 'undefined') return;

        // set the homeHeaderData for the heroHeader component
        if(typeof templateData.acf.hero_header !== 'undefined') {
          this.set('heroHeaderData', templateData.acf.hero_header[0]);
        }

        // set the aboutSubCategories for the aboutSubCategories component
        if(typeof templateData.acf.about_sub_categories !== 'undefined') {
          this.set('aboutSubCategories', templateData.acf.about_sub_categories[0]);
        }

        // set the aboutSubCategories for the aboutSubCategories component
        if(typeof templateData.acf.about_cards !== 'undefined') {
          this.set('aboutCards', templateData.acf.about_cards[0]);
        }
      },

      /** 
       * @name _hasProperty
       * @description check if an Object has properties
       *
       * @param Object
       * @returns Boolean
       */
      _hasProperty: function(obj) {
        var hasProp = false;

        for(var prop in obj) {
          var hasProp = (obj.hasOwnProperty(prop));
        }

        return hasProp;
      }
    });
  </script>
</dom-module>
