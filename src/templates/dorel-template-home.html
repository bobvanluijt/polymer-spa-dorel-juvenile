<dom-module id="dorel-template-home">
  <template>
    <style>
      .wrapper {
        float: left;
        width: 100%;
      }
    </style>

    <div class="wrapper">

      <div class="container layout horizontal center center-justified wrap">
        <div class="row">
          
          <!-- section-hero-header -->
          <template 
            is="dom-if" 
            if="[[templateData.acf.hero_header.length]]">
            <dorel-section-hero-header
              hero-header-data="[[heroHeaderData]]"
              gtm-parent="dorel-section-hero-header"
              gtm-parent-index="[[index]]"></dorel-section-hero-header>
          </template>
          <!--// section-hero-header -->

          <!-- section-cta -->
          <template 
            is="dom-if" 
            if="[[templateData.acf.ctas.length]]">

            <dorel-section-cta
              cta-data="[[templateData.acf.ctas]]"
              gtm-parent="dorel-section-cta"
              gtm-parent-index="[[index]]"></dorel-section-cta>

          </template>
          <!--// section-cta -->

          <!-- dorel-section-heroes -->
          <template 
            is="dom-if" 
            if="[[templateData.acf.heroes.length]]">
            
            <dorel-section-heroes 
              heroes-data="[[templateData.acf.heroes]]"
              gtm-parent="dorel-section-heroes"
              gtm-parent-index="[[index]]"></dorel-section-heroes>

          </template>
          <!--// dorel-section-heroes -->

          <!-- section-cards -->
          <template 
            is="dom-if" 
            if="[[homeCards.cards.length]]">

            <dorel-section-cards
              cards-data="[[homeCards]]"
              gtm-parent="dorel-section-cards"
              gtm-parent-index="[[index]]"></dorel-section-cards>

          </template>
          <!--// section-cards -->

        </div>
      </div>
      <!--// container -->

    </div>
    <!--// wrapper -->
    
  </template>

  <script>
    Polymer({
      is: 'dorel-template-home',

      properties: {
          
        /**
         * @attribute
         * @name templateData
         * @description the data coming from ACF/Wordpress which is delegated to the page builder
         */
        templateData: {
          type: Object,
          value: function() {
            return {};
          },
          observer: '_defineComponentModels'
        },

        /**
         * @name homeHeaderData
         * @description the data model used for the hero header component
         */
        heroHeaderData: Object,


        /**
         * @name home
         * @description the data model used for the cards component
         */
        homeCardsData: Object

      },

      behaviors: [DorelObjectHasPropertiesBehavior],

      /** 
       * @name _defineComponentModels
       * @description Fixed WP/ACF data is defined by an array (workaround). For components
       * that always have one item in the array a new data model is created to be set on
       * component attribute level. Binding with [0] array item selector doesn't work.
       *
       * @param Object
       */
      _defineComponentModels: function(templateData) {
        // check if the templateData has content
        if(!this._hasProperty(templateData) || typeof templateData.acf === 'undefined') return;

        // set the homeHeaderData for the heroHeader component
        if(typeof templateData.acf.hero_header !== 'undefined') {
          this.set('heroHeaderData', templateData.acf.hero_header[0]);
        }

        // set the aboutSubCategories for the aboutSubCategories component
        if(typeof templateData.acf.section_cards !== 'undefined') {
          this.set('homeCards', templateData.acf.section_cards[0]);
        }
      }
    });
  </script>
</dom-module>
