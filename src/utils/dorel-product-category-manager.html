<dom-module id="dorel-product-category-manager">
  <script>
    Polymer({
      is: 'dorel-product-category-manager',

      properties: {

        category: {
          type: Number,
          notify: true,
          value: null
        },

        sort: {
          type: Object,
          notify: true,
          value: {}
        },

        categoryPage: {
          type: Object
        }

      },

      observers: [
        '_setProductCategory(categoryPage)'
      ],

      _setProductCategory: function(categoryPage) {
        if(!categoryPage || !categoryPage.acf || !categoryPage.acf.page_builder || categoryPage.template !== 'product-category') {
          return;
        }
        var magentoSection = categoryPage.acf.page_builder.find(function(item) {
          return item.acf_fc_layout === 'section_magento';
        });
        var category = magentoSection.magento_category_picker;
        this.category = typeof category === 'string' ? parseInt(category) : category;
        this.sort = {
          type: magentoSection.magento_product_sorting,
          order: magentoSection.magento_sort_order
        };
      }
    });
  </script>
</dom-module>
