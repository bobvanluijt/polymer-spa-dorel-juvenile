<link rel="import" href="../../bower_components/app-route/app-location.html">
<link rel="import" href="../../bower_components/app-route/app-route.html">

<dom-module id="dorel-category-filter-manager">
  <template>
    <style include="iron-flex iron-flex-alignment">
      :host {
      }
    </style>
    <app-location route="{{ route }}"></app-location>
    <app-route
      route="{{ route }}"
      pattern="/:page"></app-route>
  </template>
  <script>
    Polymer({
      is: 'dorel-category-filter-manager',

      properties: {
        /**
         * @name route
         * @description this is passed by the app-route component
         */
        route: {
          type: Object,
          value: function() { return {}; }
        },

        /**
         * @name filters
         * @description Array of filters that will be passed to parent
         */
        filters: {
          type: Array,
          notify: true,
          reflectToAttribute: true,
          value: function() { return []; }
        }
      },

      observers: [
        '_getRoute(route)'
      ],

      /**
       * observer
       * @name _getRoute
       * @description will set the filters
       * @param route - Object
       * if the route changes it will check if there are queryParams in the route
       * if there are queryParams it will loop over the queryParams and set the filters Array
       */
      _getRoute: function(route) {
        if(!route || !route.__queryParams || !Object.keys(route.__queryParams).length) {
          this.filters = [];
          return;
        }
        var self = this;
        Object.keys(route.__queryParams).forEach(function(key, value) {
          var filterItem = { [key]: route.__queryParams[key] }
          self.push('filters', filterItem);
        });
      }
    });

  </script>

</dom-module>
