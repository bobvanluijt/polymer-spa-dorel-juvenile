<dom-module id="dorel-user-tools">
  <template strip-whitespace>
    <style is="custom-style" include="theme-maxicosi-shared-styles iron-flex iron-flex-alignment">
      .icn-big {
        --iron-icon-height: 2rem; /* var(--theme-icon-size-big) */
        --iron-icon-width: 2rem; /* var(--theme-icon-size-big) */
      }
      .left-spacing {
        margin-left: .5rem; /* var(--theme-molecule-space-inner) */
      }
      .icn-trigger:hover {
        cursor: pointer;
      }
      .icon-toggle-menu {
        z-index: 1001;
      }
      .centered {
        @apply(--layout-horizontal);
        @apply(--layout-center-center);
      }
      .active {
        color: white; /* var(--theme-white) */
        background-color: var(--theme-brand-color);
      }
      .active:after {
        content: '';
        background-color: var(--theme-brand-color);
        position: absolute;
        margin-top: 23px;
        height: 15px; 
        width: 100%;
      }
      iron-icon[screenMediumUp].active:after {
        margin-top: 38px;
        height: 45px;
      }
    </style>

    <iron-media-query query="(max-width : 767px)"
      query-matches="{{ screenSmall }}"></iron-media-query>
      <iron-media-query query="(min-width : 768px)"
      query-matches="{{ screenMediumUp }}"></iron-media-query>


    <!-- only show hamburger menu on small screens -->
    <template is="dom-if" if="{{ screenSmall }}">
      <div>
        <paper-icon-button
          class="paper-icn-big icon-toggle-menu"
          icon="dorel-icons:menu"
          on-click="_toggleMobileMenu"
          aria-label="menu">
        </paper-icon-button>
      </div>
    </template>

    <div class="centered">
      <iron-icon 
        icon="dorel-icons:search" 
        class="icn-big icn-trigger icn-search-section-trigger"
        on-click="_toggleSearch"
        screenMediumUp$="{{screenMediumUp}}">
      </iron-icon>
      <iron-icon 
        icon="dorel-icons:shopping-cart" 
        class="icn-big left-spacing">
      </iron-icon>
    </div>

  </template>
  <script>
    Polymer({
      is: 'dorel-user-tools',

      properties: {

        searchOpened: {
          type: Boolean,
          value: false,
          notify: true
        },

        mobileMenuOpened: {
          type: Boolean,
          value: false,
          notify: true
        }

      },

      _toggleMobileMenu: function(e) {
        this.mobileMenuOpened = !this.mobileMenuOpened;

        var iconAttr = (this.mobileMenuOpened) ? 'dorel-icons:close' : 'dorel-icons:menu';

        console.log(Polymer.dom(e).rootTarget);

        Polymer.dom(e).rootTarget.setAttribute('icon', iconAttr);
      },

      _toggleSearch: function(e) {
        // toggle the var that needs to be exposed to the host
        this.searchOpened = !this.searchOpened;

        // define icon variable needed for setting the attribute
        var iconAttr = (this.searchOpened) ? 'dorel-icons:close' : 'dorel-icons:search';

        // set icon in attribute
        Polymer.dom(e).rootTarget.setAttribute('icon', iconAttr);

        if (this.searchOpened && !Polymer.dom(e).rootTarget.classList.contains('active') ) { 
          Polymer.dom(e).rootTarget.classList.add('active'); 
        } else { 
          Polymer.dom(e).rootTarget.classList.remove('active');
        };

      }

    });
  </script>
</dom-module>


