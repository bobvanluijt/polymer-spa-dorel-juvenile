<link rel="import" href="../../bower_components/l2t-paper-slider/l2t-paper-slider.html">
<dom-module id="dorel-image-slider">
  <template>
    <style>
    :host {

      --paper-slider-dot-container-styles: {
        background-color: var(--theme-color-monochrome-4);
        border-radius: 1em;
        bottom: auto;
        bottom: 3rem;
      }

      --paper-slide-dot-styles: {
        background-color: var(--theme-color-white);
        width: .75em;
        height: .75em;
        margin: .5em;
        border-style: none;
        border: 1px solid var(--theme-color-white);
      };

      --paper-slide-dot-selected: var(--theme-brand-color-1);

      --paper-slide-height: auto;
    }

    .simple-slider-slide:focus {
      outline: none;
    }

    l2t-paper-slider {
      outline: none;
    }

    .slider--full-width {
      position: relative;
      overflow: hidden;
    }

    .slider--full-width .slider__image {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }

    .slider--full-width .slider__slide {
      position: relative;
      padding-bottom: 56.25%;
      height: 0;
      overflow: hidden;
    }

    [desktop-small-up] .slider--full-width .slider__slide {
      padding-bottom: 0;
      height: auto;
      overflow: visible;
    }

    [desktop-small-up] .slider--full-width .slider__image {
      min-height: 20rem;
      height: calc(100vh - 6.8rem);
      width: 100%;
      max-width: 100%;
      /* reset tablet < */
      top: auto;
      left: auto;
      position: static;
    }

    .slider--product .slider__image {
      height: 20rem;
      width: 100%;
      max-width: 100%;
    }

    [tablet-medium-up] .slider--product .slider__image {
      height: 28rem;
    }

    </style>

    <dorel-media-query breakpoints="{{ breakpoints }}"></dorel-media-query>

    <section class="section-slideshow"
      desktop-small-up$="{{ breakpoints.desktopSmallUp }}"
      tablet-medium-up$="{{ breakpoints.tabletMediumUp }}">
      <!-- simple-slider -->
      <l2t-paper-slider
                        class$="slider {{_getClass(type)}}"
                        id="simpleSlider"
                        position="{{ position }}"
                        hide-nav="[[ shouldHideNav(breakpoints.tabletMediumUp, hideBulletPoints) ]]"
                        slide-duration="4"
                        total-slides="[[ slides.length ]]">
        <template
          is="dom-repeat"
          items="[[ slides ]]"
          as="slide">

          <paper-slide class="slider__slide">
             <iron-image class="slider__image"
                sizing="[[ sizing ]]"
                fade="true"
                preload
                src$="[[ slide.image_url ]]"></iron-image>
          </paper-slide>

        </template>
      </l2t-paper-slider>
    </section>

  </template>

  <script>
    Polymer({
      is: 'dorel-image-slider',

      properties: {

        /**
         * @attribute
         * @name slides
         * @description Array of slides to show
         */
        slides: {
          type: Array
        },

        /**
         * @attribute
         * @name position
         * @description active position that is set by the l2t-paper-slider
         */
        position: {
          type: Number
        },

        /**
         * @attribute
         * @name breakpoints
         * @description breakpoints of the dorel-media-manager component
         */
        breakpoints: {
          type: Object
        },

        /**
         * @attribute
         * @name hideBulletPoints
         * @description boolean that will either show or hide bullet points of the l2t-paper-slider
         */
        hideBulletPoints: {
          type: Boolean
        },

        /**
         * @attribute
         * @name sizing
         * @description passed by the parent | option for the iron-image | contain or cover
         */
        sizing: {
          type: String,
          value: 'contain'
        },

        /**
         * @attribute
         * @name type
         * @description passed by the parent | option for the ratio | fullWidth or product
         */
        type: {
          type: String,
        }

      },

      observers: [
        '_updatePosition(position)'
      ],

      ready: function() {


      },

      /**
       * observer
       * @name _setSlide
       * @description Everytime the position of the active slide of the l2t-paper-slider changes
       * fire a event updatePosition with the index of the active slide
       * @param position - Number
       */
      _updatePosition: function(position) {
        this.fire('updatePosition', position);
      },

      /**
       * @name moveSliderTo
       * @description will call the public method `movePos` of the l2t-paper-slider with the index as argument
       * this will set the slide of l2t-paper-slider
       * @param index - Number
       */
      moveSliderTo: function(index) {
        this.$.simpleSlider.movePos(index);
      },

      /**
       * @name moveNext
       * @description will call the public method `moveNext` of the l2t-paper-slider
       * this will set the slide of l2t-paper-slider to the next
       */
      moveNext: function() {
        this.$.simpleSlider.moveNext();
      },

      /**
       * @name movePrevious
       * @description will call the public method `movePrevious` of the l2t-paper-slider
       * this will set the slide of l2t-paper-slider to the previous
       */
      movePrevious: function() {
        this.$.simpleSlider.movePrev();
      },

      _getClass: function(type) {
        var className;
        switch(type) {
            case 'fullWidth':
                className = 'slider--full-width';
                break;
            case 'product':
                className = 'slider--product';
                break;
            default:
              break;
        }
        return className;
      },

      shouldHideNav: function(tabletMediumUp, hideBulletPoints) {
        return hideBulletPoints || !(tabletMediumUp);
      },
    });
  </script>
</dom-module>
