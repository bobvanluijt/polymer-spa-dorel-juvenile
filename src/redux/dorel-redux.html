<link rel="import" href="../../node_modules/polymer-redux/polymer-redux.html">
<script src="../../node_modules/redux/dist/redux.js"></script>
<script src="../../node_modules/reselect/dist/reselect.js"></script>


<link rel="import" href="./actions/actions-combiner.html">
<link rel="import" href="./middleware/thunk.html">

<!-- import reducers -->
<link rel="import" href="./reducers/image-reducer.html">
<link rel="import" href="./reducers/page-reducer.html">
<link rel="import" href="./reducers/route-reducer.html">

<!-- import selectors -->
<link rel="import" href="./selectors/image-selector.html">

<script>
  (function() {

    // Set the initialState
    const initialState = {
      images: [],
      pages: []
    };

    const pages = (state = [], action) => {
      return [ ...state ];
    };

    // Combine all the reducers
    const rootReducer = Redux.combineReducers({
      images: imageReducer,
      pages: pageReducer,
      route: routeReducer
    });

    const composeEnhancers = typeof window === 'object' && window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__
      ? window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({})
      : Redux.compose;

    const enhancer = composeEnhancers(
      Redux.applyMiddleware(...middleware),
    );

    const store = Redux.createStore(rootReducer, enhancer);

    const reduxMixin = PolymerRedux(store);

    /* @mixinFunction */
    const actionsMixin = (superClass) => {
      return class extends reduxMixin(superClass) {
        static get actions() {
          return actions
        }

        static get properties() {
          return {
            actions: {
              type: Object,
              value: actions
            }
          }
        }
      }
    }
      /* @mixinFunction */
    window.ReduxMixin = Polymer.dedupingMixin(actionsMixin);
}());
</script>
