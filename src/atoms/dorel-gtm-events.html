<dom-module id="dorel-gtm-events">
  <script>
    Polymer({
      is: 'dorel-gtm-events',

      properties: {
        gtmData: {
          type: Object
        }
      },

      /**
       * define functions to run when the a specific Dorel object changes
       */
      observers: [
        '_clickEvent(globals.Dorel.events)'
      ],

      /**
       * @name _clickEvent
       * @description This function will determine if the global dorel event click
       * object is defined/changed. If so it will push the data to GA (tagmanager)
       * in the format defined by Analytics department
       */
      _clickEvent: function(dorelEvt) {

        // if the dorelEvt is not empty we will push data to gtm
        if ( this._hasProps(dorelEvt) ) {
          
          window.dataLayer = window.dataLayer || [];

          // more info http://bit.ly/2nb6I7G
          window.dataLayer.push(dorelEvt);
        }

      },

      /**
       * @name _hasProps
       * @description check if the observed data model has properties
       */
      _hasProps: function(dataObj) {
        // define dataEmpty variable to check wheter the dorelEvt object is empty or not
        var hasProps = false;

        // check for properties in the dorelEvt object
        for (var prop in dataObj) {
          hasProps = (dataObj.hasOwnProperty(prop)) ? true : false;
        }

        return hasProps;
      }
    });
  </script>
</dom-module>
