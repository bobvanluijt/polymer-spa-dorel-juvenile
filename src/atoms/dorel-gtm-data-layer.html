<dom-module id="dorel-gtm-data-layer">
  <script>
    Polymer({
      is: 'dorel-gtm-data-layer',

      properties: {
        gtmData: {
          type: Object
        }
      },

      /**
       * define functions to run when the a specific Dorel object changes
       */
      observers: [
        '_eventChange(globals.Dorel.events)'
      ],

      /**
       * @name _eventChange
       * @description This function will determine if the global dorel event
       * object is defined/changed. If so it will push the data to GA (tagmanager)
       * in the format defined by Analytics department
       *
       * more info: https://docs.google.com/presentation/d/1x5JfMGGglyHD8acEXpgSXfVGuXcUuSixbhZM6CTkSQo/edit#slide=id.p
       */
      _eventChange: function(dorelEvt) {
        // define dataEmpty variable to check wheter the dorelEvt object is empty or not
        var hasData = true;

        // check for properties in the dorelEvt object
        for (var prop in dorelEvt) {
          hasData = (dorelEvt.hasOwnProperty(prop)) ? false : true;
        }
        
        // if the dorelEvt is not empty we will push data to gtm
        if(!evtObjEmpty) {
          var eventData = {
            event: 'polymer_event',
            component: dorelEvt
          }

          console.info(eventData);
          
          window.dataLayer = window.dataLayer || [];

          window.dataLayer.push(eventData);
        }
      }
    });
  </script>
</dom-module>
