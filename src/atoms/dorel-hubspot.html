 <script
  src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
  integrity="sha256-k2WSCIexGzOj3Euiig+TlR8gA0EmPjuc79OEeY5L45g="
  crossorigin="anonymous"></script>
  
<dom-module id="dorel-hubspot">
  <template>
    <div id="form"></div>
  </template>
  <script>
    Polymer({
      is: 'dorel-hubspot',

      properties: {
        portalId: {
          type: String
        },

        formId: {
          type: String
        },

        hubSpotLoaded: {
          type: Boolean,
          value: false,
          observer: '_embedForm'
        }
      },

      _embedForm: function(newVal, oldVal) {

        if (typeof newVal === 'undefined' || !newVal ||
          typeof this.portalId === 'undefined' || this.portalId === '' || 
          typeof this.formId === 'undefined' || this.formId === '') return;

        this.activateForm = true;

        var self = this;
        
        window.hbspt.forms.create({
          css:  '' ,
          portalId: this.portalId,
          formId: this.formId,
          onFormReady: function() {
            var fragment = document.createDocumentFragment();
            fragment.appendChild(document.querySelector('.hbspt-form'));
            Polymer.dom(self.$.form).appendChild(fragment);
          }
        });
      }
    });
  </script>
</dom-module>
